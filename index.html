<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dev Grammar Checker</title>
  <style>
    body {
      background-color: #000;
      color: #0f0;
      font-family: 'Courier New', monospace;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .container {
      max-width: 900px;
      margin: 2rem;
      padding: 2rem;
      background: #111;
      border: 1px solid #0f0;
      box-shadow: 0 0 15px #0f0;
      border-radius: 10px;
    }
    textarea {
      width: 100%;
      height: 150px;
      background: #000;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 10px;
      font-size: 1rem;
      box-shadow: 0 0 10px #0f0 inset;
    }
    button {
      margin: 1rem 0.5rem;
      background: #000;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 10px 20px;
      cursor: pointer;
      box-shadow: 0 0 8px #0f0;
      font-weight: bold;
    }
    button:hover {
      background: #0f0;
      color: #000;
    }
    .panel {
      margin-top: 2rem;
      padding: 1rem;
      border: 1px solid #0f0;
      background: #111;
      box-shadow: 0 0 10px #0f0;
    }
    .dev-console {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1rem;
    }
    .dev-box {
      flex: 1;
      min-width: 250px;
      background: #000;
      color: #0f0;
      border: 1px solid #0f0;
      height: 150px;
      overflow-y: auto;
      font-size: 0.9rem;
      padding: 0.5rem;
      box-shadow: 0 0 10px #0f0 inset;
    }
    .highlight {
      color: #fff;
      background: #0f0;
      padding: 0 4px;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>SPELLDID for Indiefferential</h2>
    <textarea id="textInput" placeholder="Type your text here..."></textarea><br/>
    <button id="checkBtn">Check Grammar</button>
    <button id="autoBtn">Auto-Correct</button>

    <div id="suggestions" class="panel"></div>

    <div class="dev-console">
      <div class="dev-box" id="logLines"><strong>Console Log:</strong></div>
      <div class="dev-box" id="debugLines"><strong>Debug Info:</strong></div>
      <div class="dev-box" id="backendSim"><strong>Backend Simulation:</strong></div>
    </div>
  </div>

  <script>
    const textInput = document.getElementById('textInput');
    const checkBtn = document.getElementById('checkBtn');
    const autoBtn = document.getElementById('autoBtn');
    const suggestionsBox = document.getElementById('suggestions');
    const logLines = document.getElementById('logLines');
    const debugLines = document.getElementById('debugLines');
    const backendSim = document.getElementById('backendSim');

    function log(msg) {
      const div = document.createElement('div');
      div.textContent = msg;
      logLines.appendChild(div);
      logLines.scrollTop = logLines.scrollHeight;
    }

    function debug(msg) {
      const div = document.createElement('div');
      div.textContent = msg;
      debugLines.appendChild(div);
      debugLines.scrollTop = debugLines.scrollHeight;
    }

    function backend(msg) {
      const div = document.createElement('div');
      div.textContent = msg;
      backendSim.appendChild(div);
      backendSim.scrollTop = backendSim.scrollHeight;
    }

    const grammarRules = [
      { pattern: /\bI are\b/gi, correction: 'I am', explanation: 'Use "am" with "I"' },
      { pattern: /\bYou is\b/gi, correction: 'You are', explanation: 'Use "are" with "You"' },
      { pattern: /\b(He|She|It) are\b/gi, correction: (m) => `${m[1]} is`, explanation: 'Use "is" with 3rd person singular' },
      { pattern: /\bWe is\b/gi, correction: 'We are', explanation: 'Use "are" with "We"' },
      { pattern: /\bThey is\b/gi, correction: 'They are', explanation: 'Use "are" with "They"' },
      { pattern: /\bI goed\b/gi, correction: 'I went', explanation: '"Went" is the past tense of "go"' },
      { pattern: /\b(I|He|She|It) seen\b/gi, correction: (m) => `${m[1]} saw`, explanation: '"Saw" is the past tense of "see"' },
      { pattern: /\bHe don’t\b/gi, correction: 'He doesn’t', explanation: 'Use "doesn’t" with "He/She/It"' },
      { pattern: /\bThey doesn’t\b/gi, correction: 'They don’t', explanation: 'Use "don’t" with plural subject' },
      { pattern: /\bdefinately\b/gi, correction: 'definitely', explanation: 'Spelling: "definitely"' },
      { pattern: /\bseperate\b/gi, correction: 'separate', explanation: 'Spelling: "separate"' },
    ];

    function checkGrammar(text) {
      log("Checking grammar...");
      backend("Backend: Parsing input...");
      const issues = [];
      grammarRules.forEach(rule => {
        let match;
        while ((match = rule.pattern.exec(text)) !== null) {
          const original = match[0];
          const correction = typeof rule.correction === 'function' ? rule.correction(match) : rule.correction;
          issues.push({ original, correction, explanation: rule.explanation });
          debug(`Match: "${original}" ➜ "${correction}"`);
          backend(`Rule Applied: "${original}" corrected to "${correction}"`);
        }
      });
      backend("Backend: Finished rule matching.");
      return issues;
    }

    function renderSuggestions(issues) {
      suggestionsBox.innerHTML = '';
      if (issues.length === 0) {
        suggestionsBox.textContent = '✅ No grammar issues found.';
        return;
      }
      issues.forEach((issue, i) => {
        const div = document.createElement('div');
        div.innerHTML = `<strong>Issue ${i + 1}:</strong> "<span class="highlight">${issue.original}</span>" → "<span class="highlight">${issue.correction}</span>"<br/><em>${issue.explanation}</em>`;
        suggestionsBox.appendChild(div);
      });
    }

    function autoCorrect(text) {
      log("Auto-correcting...");
      backend("Backend: Running auto-correction...");
      grammarRules.forEach(rule => {
        if (typeof rule.correction === 'function') {
          text = text.replace(rule.pattern, (...args) => rule.correction(args));
        } else {
          text = text.replace(rule.pattern, rule.correction);
        }
      });
      backend("Backend: Auto-correction complete.");
      return text;
    }

    checkBtn.onclick = () => {
      logLines.innerHTML = '';
      debugLines.innerHTML = '';
      backendSim.innerHTML = '';
      const inputText = textInput.value;
      const issues = checkGrammar(inputText);
      renderSuggestions(issues);
    };

    autoBtn.onclick = () => {
      logLines.innerHTML = '';
      debugLines.innerHTML = '';
      backendSim.innerHTML = '';
      let text = textInput.value;
      text = autoCorrect(text);
      textInput.value = text;
      const issues = checkGrammar(text);
      renderSuggestions(issues);
    };
  </script>
</body>
</html>
